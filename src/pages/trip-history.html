<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Trips - TripleFun</title>
  <link href="../output.css" rel="stylesheet" />
</head>
<body class="bg-gray-50 font-sans text-gray-800 min-h-screen flex flex-col">
  <header class="bg-sky-500 text-white p-4 shadow-md">
    <div class="container mx-auto flex flex-wrap items-center justify-between gap-2 px-4 py-2">
      <!-- Logo and Title -->
      <div class="flex items-center space-x-2 md:space-x-3 justify-start md:justify-start
                  w-full md:w-auto flex-shrink-0">
        <a href="../index.html" class="flex items-center space-x-2 md:space-x-3 cursor-pointer">
          <!-- SVG for the logo, responsive sizing with Tailwind classes -->
          <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 md:w-12 md:h-12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M6 20a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2"/>
            <path d="M8 18V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v14"/>
            <path d="M10 20h4"/><circle cx="16" cy="20" r="2"/>
            <circle cx="8" cy="20" r="2"/>
          </svg>
          <!-- Title with responsive font sizes -->
          <h1 class="text-2xl md:text-4xl font-bold">TripleFun</h1>
        </a>
      </div>

      <!-- Navigation -->
      <nav class="flex justify-center
                  w-full md:w-auto order-last md:order-none flex-grow">
        <ul class="flex flex-row space-x-2 md:space-x-4 text-base md:text-xl items-center">
          <li><a href="../index.html" class="px-3 md:px-5 py-2 md:py-3 rounded-full border border-transparent hover:bg-sky-600 hover:text-white transition duration-300">Stays</a></li>
          <li><a href="../flights.html" class="px-3 md:px-5 py-2 md:py-3 rounded-full border border-transparent hover:bg-sky-600 hover:text-white transition duration-300">Flights</a></li>
        </ul>
      </nav>

      <!-- User Login/Signup -->
      <div id="user-auth-area" class="flex space-x-2 md:space-x-3 text-base md:text-xl justify-center md:justify-end items-center ml-auto
      w-full md:w-48 md:max-w-64 flex-shrink-0">
        <!-- Loading placeholder -->
        <div class="relative min-w-[273px] flex justify-center items-center space-x-2 md:space-x-3">
          <div class="w-4 h-4 md:w-5 md:h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto p-6 flex-grow">
    <!-- Sub Navigation Tabs -->
    <div class="mt-6 mb-4">
      <nav class="bg-sky-100 rounded-lg p-2 flex space-x-4 text-sm font-semibold">
        <a href="profile.html" class="px-4 py-2 rounded-md text-sky-900 hover:bg-sky-200 transition">Profile</a>
        <a href="trip-history.html" class="px-4 py-2 rounded-md text-sky-900 bg-white hover:bg-sky-200 transition">Trip History</a>
        <a href="support.html" class="px-4 py-2 rounded-md text-sky-900 hover:bg-sky-200 transition">Support</a>
        <a href="setting.html" class="px-4 py-2 rounded-md text-sky-900 hover:bg-sky-200 transition">Setting</a>
      </nav>
    </div>
    <h2 class="text-3xl font-bold text-gray-800 mb-6">My Trips</h2>

    <!-- Tabs -->
    <div class="mb-6">
      <ul class="flex text-sm font-medium text-gray-600">
        <li class="-mb-px mr-4">
          <button class="tab-btn font-semibold border-b-2 border-blue-600 pb-2 transition duration-300 ease-in-out" onclick="setActiveSort(this)" data-status="upcoming">Upcoming</button>
        </li>
        <li class="mr-4">
          <button class="tab-btn text-gray-500 cursor-pointer hover:font-semibold hover:pb-1 hover:border-b-2 hover:border-blue-600 transition duration-300 ease-in-out" onclick="setActiveSort(this)" data-status="completed">Completed</button>
        </li>
        <li>
          <button class="tab-btn text-gray-500 cursor-pointer hover:font-semibold hover:pb-1 hover:border-b-2 hover:border-blue-600 transition duration-300 ease-in-out" onclick="setActiveSort(this)" data-status="cancelled">Cancelled</button>
        </li>
      </ul>
    </div>

    <!-- Trip List -->
    <div class="space-y-6">

      <!-- Message for no trips found -->
      <div id="no-trips-message" class="hidden bg-white rounded-lg shadow-md p-6 text-center text-gray-600">
        <p class="text-lg">No <span id="current-status-text"></span> trips found.</p>
      </div>

      <!-- Trip Card -->
      <div class="trip-card bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition" data-status="upcoming">
        <div class="flex justify-between items-start">
          <div>
            <h3 class="text-xl font-semibold text-sky-800">Hotel Stripes Kuala Lumpur</h3>
            <p class="text-sm text-gray-600 mt-1">Check-in: Aug 5, 2025 – Check-out: Aug 9, 2025</p>
            <p class="text-sm text-gray-500">Booking ID: #TRP98421</p>
          </div>
          <span class="bg-green-100 text-green-700 px-3 py-1 text-sm rounded-full">Confirmed</span>
        </div>
        <div class="mt-4 flex justify-end">
          <a href="trip-detail1.html"
            class="text-sm text-blue-600 font-medium hover:underline">View details →</a>
        </div>
      </div>

      <!-- Another Trip Card -->
      <div class="trip-card bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition" data-status="upcoming">
        <div class="flex justify-between items-start">
          <div>
            <h3 class="text-xl font-semibold text-sky-800">Flight to Langkawi</h3>
            <p class="text-sm text-gray-600 mt-1">Departure: Sep 2, 2025 – Return: Sep 7, 2025</p>
            <p class="text-sm text-gray-500">Booking ID: #FLG23512</p>
          </div>
          <span class="bg-yellow-100 text-yellow-700 px-3 py-1 text-sm rounded-full">Pending Check-in</span>
        </div>
        <div class="mt-4 flex justify-end">
          <a href="trip-detail2.html"
            class="text-sm text-blue-600 font-medium hover:underline">View details →</a>
        </div>
      </div>

      <!-- Add more cards here -->

    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-sky-500 text-white p-3 shadow-inner">
    <div class="container mx-auto text-center text-sm">
      <p class="mb-2">&copy; 2025 TripleFun. All rights reserved.</p>
      <div class="flex justify-center space-x-4">
        <a href="#" class="hover:text-sky-200 transition duration-300">Privacy Policy</a>
        <a href="#" class="hover:text-sky-200 transition duration-300">Terms of Service</a>
      </div>
    </div>
  </footer>

  <script>
    window.setActiveSort = function(button) {
        // Remove active styles from all sort buttons
        const sortButtons = document.querySelectorAll('.tab-btn');
        sortButtons.forEach(btn => {
            btn.classList.remove('font-semibold', 'border-b-2', 'border-blue-600', 'pb-2');
            btn.classList.add('text-gray-500', 'cursor-pointer', 'hover:font-semibold', 'hover:pb-1', 'hover:border-b-2', 'hover:border-blue-600');
        });

        // Add active styles to the clicked button
        button.classList.add('font-semibold', 'border-b-2', 'border-blue-600', 'pb-2');
        button.classList.remove('text-gray-500', 'cursor-pointer', 'hover:font-semibold', 'hover:pb-1', 'hover:border-b-2', 'hover:border-blue-600');

        // Get the status to filter by
        const selectedStatus = button.dataset.status;
        console.log('Selected tab status:', selectedStatus); // Debugging: Log the selected status
        const tripCards = document.querySelectorAll('.trip-card');
        const noTripsMessage = document.getElementById('no-trips-message');
        const currentStatusText = document.getElementById('current-status-text');
        let cardsFound = false; // Flag to track if any cards are found for the selected status

        // First, hide all cards
        tripCards.forEach(card => {
            card.classList.add('hidden');
        });

        // Then, show only the cards that match the selected status
        tripCards.forEach(card => {
            if (card.dataset.status === selectedStatus) {
                card.classList.remove('hidden');
                cardsFound = true; // Set flag to true if a card is found
                console.log('Showing card:', card.querySelector('h3').textContent, 'with status:', card.dataset.status); // Debugging: Log shown cards
            }
        });

        // Display or hide the "no trips" message based on cardsFound flag
        if (cardsFound) {
            noTripsMessage.classList.add('hidden');
        } else {
            currentStatusText.textContent = selectedStatus; // Update the status text in the message
            noTripsMessage.classList.remove('hidden');
        }
      };

      // Set initial state: display only "Upcoming" trips
      document.addEventListener('DOMContentLoaded', () => {
          const upcomingButton = document.querySelector('.tab-btn[data-status="upcoming"]');
          if (upcomingButton) {
              window.setActiveSort(upcomingButton);
          }
      });
  </script>


  <!-- Firebase user state management -->
  <script type="module">
    import { initAuthState } from "../scripts/auth.js";
    
    // Initialize user authentication state
    document.addEventListener('DOMContentLoaded', () => {
      initAuthState();
    });
  </script>
</body>
</html>